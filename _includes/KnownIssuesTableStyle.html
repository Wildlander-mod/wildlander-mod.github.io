<style>
.known-issues-controls {
  margin-bottom: 20px;
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
  align-items: center;
  background: #462b53;
  padding: 15px;
  border-radius: 4px;
  border: 1px solid #50098a;
}

.known-issues-controls label {
  font-weight: 600;
  color: #f77ef1;
  margin-right: 5px;
}

.known-issues-controls input,
.known-issues-controls select {
  padding: 8px 12px;
  border: 1px solid #50098a;
  border-radius: 4px;
  font-size: 14px;
  background: #222222;
  color: #e6e6e6;
  font-family: inherit;
}

.known-issues-controls input[type="text"] {
  min-width: 300px;
  flex: 1;
}

.known-issues-controls input[type="text"]::placeholder {
  color: #888;
}

.known-issues-controls select {
  min-width: 150px;
  background: white;
  cursor: pointer;
}

.known-issues-controls select:hover {
  border-color: #f77ef1;
}

.known-issues-controls button {
  padding: 8px 16px;
  background-color: #50098a;
  color: #ffffff;
  border: 1px solid #50098a;
  border-radius: 4px;
  cursor: pointer;
  font-size: 14px;
  font-weight: 500;
  transition: background-color 0.2s;
}

.known-issues-controls button:hover {
  background-color: #f77ef1;
  color: #222222;
  border-color: #f77ef1;
}

.known-issues-controls button:active {
  background-color: #e94ee1;
}

.known-issues-table {
  width: 100%;
  overflow-x: auto;
  margin-top: 20px;
}

.known-issues-table table {
  width: 100%;
  border-collapse: collapse;
  border: 2px solid #50098a;
}

.known-issues-table th,
.known-issues-table td {
  border: 1px solid #50098a;
  padding: 12px;
  text-align: left;
  vertical-align: top;
}

.known-issues-table th {
  background-color: #50098a;
  color: #ffffff;
  font-weight: 600;
  font-size: 13px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

/* ID column - minimal width */
.known-issues-table th:nth-child(1),
.known-issues-table td:nth-child(1) {
  width: 80px;
  word-break: break-word;
  font-weight: 500;
}

/* Category column */
.known-issues-table th:nth-child(2),
.known-issues-table td:nth-child(2) {
  width: 100px;
  word-break: break-word;
}

/* Summary column */
.known-issues-table th:nth-child(3),
.known-issues-table td:nth-child(3) {
  width: 150px;
  word-break: break-word;
}

/* Description column - 10 character width max, wrap as needed */
.known-issues-table th:nth-child(4),
.known-issues-table td:nth-child(4) {
  width: 80px;
  word-break: break-word;
  white-space: normal;
}

/* Status column */
.known-issues-table th:nth-child(5),
.known-issues-table td:nth-child(5) {
  width: 100px;
  word-break: break-word;
}

/* Investigation column - 10 character width max, wrap as needed */
.known-issues-table th:nth-child(6),
.known-issues-table td:nth-child(6) {
  width: 80px;
  word-break: break-word;
  white-space: normal;
}

/* Notes column */
.known-issues-table th:nth-child(7),
.known-issues-table td:nth-child(7) {
  width: 150px;
  word-break: break-word;
}

.known-issues-table tbody tr:nth-child(odd) {
  background-color: #222222;
}

.known-issues-table tbody tr:nth-child(even) {
  background-color: #2a2a2a;
}

.known-issues-table tbody tr:hover {
  background-color: #3d2454;
}

.known-issues-table tr.hidden {
  display: none;
}

.known-issues-table tr.header {
  display: table-row !important;
}

.filter-result-count {
  font-size: 13px;
  color: #f77ef1;
  margin-top: 10px;
  font-weight: 500;
}

/* Tooltip Styles */
.issue-tooltip {
  position: absolute;
  background-color: #222222;
  border: 2px solid #50098a;
  border-radius: 6px;
  padding: 20px;
  max-width: 500px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.6);
  z-index: 1000;
  font-size: 13px;
  display: none;
  pointer-events: none;
}

.issue-tooltip.active {
  display: block;
}

.issue-tooltip-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
  padding-bottom: 12px;
  border-bottom: 1px solid #50098a;
}

.issue-tooltip-id {
  font-size: 16px;
  font-weight: 700;
  color: #f77ef1;
  letter-spacing: 0.5px;
}

.issue-tooltip-category {
  display: inline-block;
  background-color: #50098a;
  color: #ffffff;
  padding: 4px 10px;
  border-radius: 3px;
  font-weight: 600;
  text-transform: uppercase;
  font-size: 11px;
  letter-spacing: 0.3px;
}

.issue-tooltip-row {
  margin-bottom: 12px;
  line-height: 1.4;
}

.issue-tooltip-label {
  color: #f77ef1;
  font-weight: 600;
  display: block;
  margin-bottom: 4px;
  text-transform: uppercase;
  font-size: 11px;
  letter-spacing: 0.3px;
}

.issue-tooltip-value {
  color: #e6e6e6;
  padding-left: 8px;
  border-left: 2px solid #462b53;
}

.known-issues-table td:nth-child(1) {
  cursor: pointer;
  transition: color 0.2s;
}

.known-issues-table td:nth-child(1):hover {
  color: #f77ef1;
}
</style>

<div class="known-issues-controls">
  <input type="text" id="knownIssuesSearch" placeholder="Search (Summary, Description, Notes)..." />
  <select id="categoryFilter">
    <option value="">All Categories</option>
  </select>
  <select id="statusFilter">
    <option value="">All Status</option>
  </select>
  <button id="clearFilters" onclick="clearKnownIssuesFilters()">Clear Filters</button>
</div>
<div class="filter-result-count" id="filterResultCount"></div>

<script>
function initKnownIssuesFilters() {
  const table = document.querySelector('.known-issues-table table');
  if (!table) return;
  
  const rows = Array.from(table.querySelectorAll('tbody tr'));
  const categories = new Set();
  const statuses = new Set();
  
  rows.forEach(row => {
    const cells = row.querySelectorAll('td');
    if (cells.length >= 5) {
      categories.add(cells[1].textContent.trim());
      statuses.add(cells[4].textContent.trim());
    }
  });
  
  const categorySelect = document.getElementById('categoryFilter');
  const statusSelect = document.getElementById('statusFilter');
  
  Array.from(categories).sort().forEach(cat => {
    const option = document.createElement('option');
    option.value = cat;
    option.textContent = cat;
    categorySelect.appendChild(option);
  });
  
  Array.from(statuses).sort().forEach(status => {
    const option = document.createElement('option');
    option.value = status;
    option.textContent = status;
    statusSelect.appendChild(option);
  });
  
  document.getElementById('knownIssuesSearch').addEventListener('input', filterKnownIssuesTable);
  categorySelect.addEventListener('change', filterKnownIssuesTable);
  statusSelect.addEventListener('change', filterKnownIssuesTable);
  
  // Initialize tooltips for ID cells
  initKnownIssuestooltips();
  
  updateFilterCount();
}

function initKnownIssuestooltips() {
  const table = document.querySelector('.known-issues-table table');
  if (!table) return;
  
  // Create tooltip container
  let tooltip = document.getElementById('knownIssuestooltip');
  if (!tooltip) {
    tooltip = document.createElement('div');
    tooltip.id = 'knownIssuestooltip';
    tooltip.className = 'issue-tooltip';
    document.body.appendChild(tooltip);
  }
  
  const rows = table.querySelectorAll('tbody tr');
  
  rows.forEach(row => {
    const cells = row.querySelectorAll('td');
    if (cells.length < 7) return;
    
    const idCell = cells[0];
    const id = cells[0].textContent.trim();
    const category = cells[1].textContent.trim();
    const summary = cells[2].textContent.trim();
    const description = cells[3].textContent.trim();
    const status = cells[4].textContent.trim();
    const investigation = cells[5].textContent.trim();
    const notes = cells[6].textContent.trim();
    
    idCell.addEventListener('mouseenter', (e) => {
      showKnownIssuestooltip(e, {id, category, summary, description, status, investigation, notes});
    });
    
    idCell.addEventListener('mouseleave', hideKnownIssuestooltip);
  });
}

function showKnownIssuestooltip(event, data) {
  const tooltip = document.getElementById('knownIssuestooltip');
  if (!tooltip) return;
  
  tooltip.innerHTML = `
    <div class="issue-tooltip-header">
      <div class="issue-tooltip-id">${data.id}</div>
      <div class="issue-tooltip-category">${data.category}</div>
    </div>
    ${data.summary ? `<div class="issue-tooltip-row">
      <span class="issue-tooltip-label">Summary</span>
      <div class="issue-tooltip-value">${data.summary}</div>
    </div>` : ''}
    ${data.description ? `<div class="issue-tooltip-row">
      <span class="issue-tooltip-label">Description</span>
      <div class="issue-tooltip-value">${data.description}</div>
    </div>` : ''}
    ${data.status ? `<div class="issue-tooltip-row">
      <span class="issue-tooltip-label">Status</span>
      <div class="issue-tooltip-value">${data.status}</div>
    </div>` : ''}
    ${data.investigation ? `<div class="issue-tooltip-row">
      <span class="issue-tooltip-label">Investigation</span>
      <div class="issue-tooltip-value">${data.investigation}</div>
    </div>` : ''}
    ${data.notes ? `<div class="issue-tooltip-row">
      <span class="issue-tooltip-label">Notes</span>
      <div class="issue-tooltip-value">${data.notes}</div>
    </div>` : ''}
  `;
  
  tooltip.classList.add('active');
  
  // Position tooltip near cursor
  const rect = event.target.getBoundingClientRect();
  tooltip.style.left = (rect.left + window.scrollX) + 'px';
  tooltip.style.top = (rect.bottom + window.scrollY + 8) + 'px';
}

function hideKnownIssuestooltip() {
  const tooltip = document.getElementById('knownIssuestooltip');
  if (tooltip) {
    tooltip.classList.remove('active');
  }
}

function filterKnownIssuesTable() {
  const table = document.querySelector('.known-issues-table table');
  if (!table) return;
  
  const searchTerm = document.getElementById('knownIssuesSearch').value.toLowerCase();
  const categoryFilter = document.getElementById('categoryFilter').value;
  const statusFilter = document.getElementById('statusFilter').value;
  
  const rows = table.querySelectorAll('tbody tr');
  let visibleCount = 0;
  
  rows.forEach(row => {
    const cells = row.querySelectorAll('td');
    if (cells.length < 7) return;
    
    const id = cells[0].textContent.toLowerCase();
    const category = cells[1].textContent.trim();
    const summary = cells[2].textContent.toLowerCase();
    const description = cells[3].textContent.toLowerCase();
    const status = cells[4].textContent.trim();
    const investigation = cells[5].textContent.toLowerCase();
    const notes = cells[6].textContent.toLowerCase();
    
    const matchesSearch = !searchTerm || 
                         id.includes(searchTerm) ||
                         summary.includes(searchTerm) ||
                         description.includes(searchTerm) ||
                         investigation.includes(searchTerm) ||
                         notes.includes(searchTerm);
    
    const matchesCategory = !categoryFilter || category === categoryFilter;
    const matchesStatus = !statusFilter || status === statusFilter;
    
    const isVisible = matchesSearch && matchesCategory && matchesStatus;
    
    if (isVisible) {
      row.classList.remove('hidden');
      visibleCount++;
    } else {
      row.classList.add('hidden');
    }
  });
  
  updateFilterCount(visibleCount, rows.length);
}

function updateFilterCount(visible, total) {
  const table = document.querySelector('.known-issues-table table');
  if (!table) return;
  
  if (visible === undefined) {
    visible = table.querySelectorAll('tbody tr:not(.hidden)').length;
    total = table.querySelectorAll('tbody tr').length;
  }
  
  const countElement = document.getElementById('filterResultCount');
  if (countElement) {
    countElement.textContent = `Showing ${visible} of ${total} issues`;
  }
}

function clearKnownIssuesFilters() {
  document.getElementById('knownIssuesSearch').value = '';
  document.getElementById('categoryFilter').value = '';
  document.getElementById('statusFilter').value = '';
  filterKnownIssuesTable();
}

document.addEventListener('DOMContentLoaded', initKnownIssuesFilters);
</script>

<div class="known-issues-table" markdown="1">
